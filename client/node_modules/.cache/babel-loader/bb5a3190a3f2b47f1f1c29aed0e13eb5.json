{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from) {\n  for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];\n\n  return to;\n};\n/* eslint-disable camelcase */\n\n\nimport * as React from 'react';\nimport memoize from 'memoize-one';\nimport Actions from './components/Actions';\nimport Content from './components/Content';\nimport Controls from './components/Controls';\nimport ErrorMessage from './components/ErrorMessage';\nimport Info from './components/Info';\nimport Loader from './components/Loader';\nimport Player from './components/Player';\nimport Slider from './components/Slider';\nimport { getDevices, getPlaybackState, next, pause, play, previous, seek, setDevice, setVolume } from './spotify';\nimport { getMergedStyles } from './styles';\nimport { getSpotifyURIType, isEqualArray, loadSpotifyPlayer, parseVolume, round, STATUS, TYPE, validateURI } from './utils';\n\nvar SpotifyWebPlayer =\n/** @class */\nfunction (_super) {\n  __extends(SpotifyWebPlayer, _super);\n\n  function SpotifyWebPlayer(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.isActive = false;\n    _this.emptyTrack = {\n      artists: '',\n      durationMs: 0,\n      id: '',\n      image: '',\n      name: '',\n      uri: ''\n    };\n    _this.getPlayOptions = memoize(function (data) {\n      var playOptions = {\n        context_uri: undefined,\n        uris: undefined\n      };\n      /* istanbul ignore else */\n\n      if (data) {\n        var ids = Array.isArray(data) ? data : [data];\n\n        if (!ids.every(function (d) {\n          return validateURI(d);\n        })) {\n          // eslint-disable-next-line no-console\n          console.error('Invalid URI');\n          return playOptions;\n        }\n\n        if (ids.some(function (d) {\n          return getSpotifyURIType(d) === 'track';\n        })) {\n          if (!ids.every(function (d) {\n            return getSpotifyURIType(d) === 'track';\n          })) {\n            // eslint-disable-next-line no-console\n            console.warn(\"You can't mix tracks URIs with other types\");\n          }\n\n          playOptions.uris = ids.filter(function (d) {\n            return validateURI(d) && getSpotifyURIType(d) === 'track';\n          });\n        } else {\n          if (ids.length > 1) {\n            // eslint-disable-next-line no-console\n            console.warn(\"Albums, Artists, Playlists and Podcasts can't have multiple URIs\");\n          } // eslint-disable-next-line prefer-destructuring\n\n\n          playOptions.context_uri = ids[0];\n        }\n      }\n\n      return playOptions;\n    });\n    _this.hasNewToken = false;\n    _this.ref = React.createRef();\n    _this.seekUpdateInterval = 100;\n\n    _this.handleChangeRange = function (position) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var track, _a, callback, token, progress, percentage, state, error_1;\n\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              track = this.state.track;\n              _a = this.props, callback = _a.callback, token = _a.token;\n              progress = 0;\n              _b.label = 1;\n\n            case 1:\n              _b.trys.push([1, 8,, 9]);\n\n              percentage = position / 100;\n              if (!this.isExternalPlayer) return [3\n              /*break*/\n              , 3];\n              progress = Math.round(track.durationMs * percentage);\n              return [4\n              /*yield*/\n              , seek(token, progress)];\n\n            case 2:\n              _b.sent();\n\n              this.updateState({\n                position: position,\n                progressMs: progress\n              });\n              return [3\n              /*break*/\n              , 7];\n\n            case 3:\n              if (!this.player) return [3\n              /*break*/\n              , 7];\n              return [4\n              /*yield*/\n              , this.player.getCurrentState()];\n\n            case 4:\n              state = _b.sent();\n              if (!state) return [3\n              /*break*/\n              , 6];\n              progress = Math.round(state.track_window.current_track.duration_ms * percentage);\n              return [4\n              /*yield*/\n              , this.player.seek(progress)];\n\n            case 5:\n              _b.sent();\n\n              this.updateState({\n                position: position,\n                progressMs: progress\n              });\n              return [3\n              /*break*/\n              , 7];\n\n            case 6:\n              this.updateState({\n                position: 0\n              });\n              _b.label = 7;\n\n            case 7:\n              if (callback) {\n                callback(__assign(__assign({}, this.state), {\n                  type: TYPE.PROGRESS\n                }));\n              }\n\n              return [3\n              /*break*/\n              , 9];\n\n            case 8:\n              error_1 = _b.sent(); // eslint-disable-next-line no-console\n\n              console.error(error_1);\n              return [3\n              /*break*/\n              , 9];\n\n            case 9:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.handleClickTogglePlay = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var isActive, error_2;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              isActive = this.state.isActive;\n              _a.label = 1;\n\n            case 1:\n              _a.trys.push([1, 3,, 4]);\n\n              return [4\n              /*yield*/\n              , this.togglePlay(!this.isExternalPlayer && !isActive)];\n\n            case 2:\n              _a.sent();\n\n              return [3\n              /*break*/\n              , 4];\n\n            case 3:\n              error_2 = _a.sent(); // eslint-disable-next-line no-console\n\n              console.error(error_2);\n              return [3\n              /*break*/\n              , 4];\n\n            case 4:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.handleClickPrevious = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var token, error_3;\n\n        var _this = this;\n\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              _a.trys.push([0, 5,, 6]);\n\n              if (!this.isExternalPlayer) return [3\n              /*break*/\n              , 2];\n              token = this.props.token;\n              return [4\n              /*yield*/\n              , previous(token)];\n\n            case 1:\n              _a.sent();\n\n              this.syncTimeout = window.setTimeout(function () {\n                _this.syncDevice();\n              }, 300);\n              return [3\n              /*break*/\n              , 4];\n\n            case 2:\n              if (!this.player) return [3\n              /*break*/\n              , 4];\n              return [4\n              /*yield*/\n              , this.player.previousTrack()];\n\n            case 3:\n              _a.sent();\n\n              _a.label = 4;\n\n            case 4:\n              return [3\n              /*break*/\n              , 6];\n\n            case 5:\n              error_3 = _a.sent(); // eslint-disable-next-line no-console\n\n              console.error(error_3);\n              return [3\n              /*break*/\n              , 6];\n\n            case 6:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.handleClickNext = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var token, error_4;\n\n        var _this = this;\n\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              _a.trys.push([0, 5,, 6]);\n\n              if (!this.isExternalPlayer) return [3\n              /*break*/\n              , 2];\n              token = this.props.token;\n              return [4\n              /*yield*/\n              , next(token)];\n\n            case 1:\n              _a.sent();\n\n              this.syncTimeout = window.setTimeout(function () {\n                _this.syncDevice();\n              }, 300);\n              return [3\n              /*break*/\n              , 4];\n\n            case 2:\n              if (!this.player) return [3\n              /*break*/\n              , 4];\n              return [4\n              /*yield*/\n              , this.player.nextTrack()];\n\n            case 3:\n              _a.sent();\n\n              _a.label = 4;\n\n            case 4:\n              return [3\n              /*break*/\n              , 6];\n\n            case 5:\n              error_4 = _a.sent(); // eslint-disable-next-line no-console\n\n              console.error(error_4);\n              return [3\n              /*break*/\n              , 6];\n\n            case 6:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.handleClickDevice = function (deviceId) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var isUnsupported, _a, autoPlay, persistDeviceSelection, token, player, error_5;\n\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              isUnsupported = this.state.isUnsupported;\n              _a = this.props, autoPlay = _a.autoPlay, persistDeviceSelection = _a.persistDeviceSelection, token = _a.token;\n              this.updateState({\n                currentDeviceId: deviceId\n              });\n              _b.label = 1;\n\n            case 1:\n              _b.trys.push([1, 7,, 8]);\n\n              return [4\n              /*yield*/\n              , setDevice(token, deviceId)];\n\n            case 2:\n              _b.sent();\n              /* istanbul ignore else */\n\n\n              if (persistDeviceSelection) {\n                sessionStorage.setItem('rswpDeviceId', deviceId);\n              }\n\n              if (!isUnsupported) return [3\n              /*break*/\n              , 6];\n              return [4\n              /*yield*/\n              , this.syncDevice()];\n\n            case 3:\n              _b.sent();\n\n              return [4\n              /*yield*/\n              , getPlaybackState(token)];\n\n            case 4:\n              player = _b.sent();\n              if (!(player && !player.is_playing && autoPlay)) return [3\n              /*break*/\n              , 6];\n              return [4\n              /*yield*/\n              , this.togglePlay(true)];\n\n            case 5:\n              _b.sent();\n\n              _b.label = 6;\n\n            case 6:\n              return [3\n              /*break*/\n              , 8];\n\n            case 7:\n              error_5 = _b.sent(); // eslint-disable-next-line no-console\n\n              console.error(error_5);\n              return [3\n              /*break*/\n              , 8];\n\n            case 8:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.handleFavoriteStatusChange = function (status) {\n      var isSaved = _this.state.isSaved;\n      var callback = _this.props.callback;\n\n      _this.updateState({\n        isSaved: status\n      });\n      /* istanbul ignore else */\n\n\n      if (isSaved !== status) {\n        callback(__assign(__assign({}, __assign(__assign({}, _this.state), {\n          isSaved: status\n        })), {\n          type: TYPE.FAVORITE\n        }));\n      }\n    };\n\n    _this.handlePlayerErrors = function (type, message) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var status, isPlaybackError, isInitializationError, nextStatus, devices, token;\n\n        var _a;\n\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              status = this.state.status;\n              isPlaybackError = type === 'playback_error';\n              isInitializationError = type === 'initialization_error';\n              nextStatus = status;\n              devices = [];\n              if (!(this.player && !isPlaybackError)) return [3\n              /*break*/\n              , 2];\n              return [4\n              /*yield*/\n              , this.player.disconnect()];\n\n            case 1:\n              _b.sent();\n\n              _b.label = 2;\n\n            case 2:\n              if (!isInitializationError) return [3\n              /*break*/\n              , 4];\n              nextStatus = STATUS.UNSUPPORTED;\n              token = this.props.token;\n              return [4\n              /*yield*/\n              , getDevices(token)];\n\n            case 3:\n              _a = _b.sent().devices, devices = _a === void 0 ? [] : _a;\n              _b.label = 4;\n\n            case 4:\n              if (!isInitializationError && !isPlaybackError) {\n                nextStatus = STATUS.ERROR;\n              }\n\n              this.updateState({\n                devices: devices,\n                error: message,\n                errorType: type,\n                isInitializing: false,\n                isUnsupported: isInitializationError,\n                status: nextStatus\n              });\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.handlePlayerStateChanges = function (state) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var paused, position, _a, _b, album, artists, duration_ms, id, name_1, uri, next_tracks, previous_tracks, isPlaying, volume, track, trackState, error_6;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              _c.trys.push([0, 6,, 7]);\n\n              if (!state) return [3\n              /*break*/\n              , 2];\n              paused = state.paused, position = state.position, _a = state.track_window, _b = _a.current_track, album = _b.album, artists = _b.artists, duration_ms = _b.duration_ms, id = _b.id, name_1 = _b.name, uri = _b.uri, next_tracks = _a.next_tracks, previous_tracks = _a.previous_tracks;\n              isPlaying = !paused;\n              return [4\n              /*yield*/\n              , this.player.getVolume()];\n\n            case 1:\n              volume = _c.sent();\n              track = {\n                artists: artists.map(function (d) {\n                  return d.name;\n                }).join(', '),\n                durationMs: duration_ms,\n                id: id,\n                image: this.setAlbumImage(album),\n                name: name_1,\n                uri: uri\n              };\n              trackState = void 0;\n\n              if (position === 0) {\n                trackState = {\n                  nextTracks: next_tracks,\n                  position: 0,\n                  previousTracks: previous_tracks,\n                  track: track\n                };\n              }\n\n              this.updateState(__assign({\n                error: '',\n                errorType: '',\n                isActive: true,\n                isPlaying: isPlaying,\n                progressMs: position,\n                volume: round(volume)\n              }, trackState));\n              return [3\n              /*break*/\n              , 5];\n\n            case 2:\n              if (!this.isExternalPlayer) return [3\n              /*break*/\n              , 4];\n              return [4\n              /*yield*/\n              , this.syncDevice()];\n\n            case 3:\n              _c.sent();\n\n              return [3\n              /*break*/\n              , 5];\n\n            case 4:\n              this.updateState({\n                isActive: false,\n                isPlaying: false,\n                nextTracks: [],\n                position: 0,\n                previousTracks: [],\n                track: {\n                  artists: '',\n                  durationMs: 0,\n                  id: '',\n                  image: '',\n                  name: '',\n                  uri: ''\n                }\n              });\n              _c.label = 5;\n\n            case 5:\n              return [3\n              /*break*/\n              , 7];\n\n            case 6:\n              error_6 = _c.sent(); // eslint-disable-next-line no-console\n\n              console.error(error_6);\n              return [3\n              /*break*/\n              , 7];\n\n            case 7:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.handlePlayerStatus = function (_a) {\n      var device_id = _a.device_id;\n      return __awaiter(_this, void 0, void 0, function () {\n        var _b, currentDeviceId, devices;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              return [4\n              /*yield*/\n              , this.initializeDevices(device_id)];\n\n            case 1:\n              _b = _c.sent(), currentDeviceId = _b.currentDeviceId, devices = _b.devices;\n              this.updateState({\n                currentDeviceId: currentDeviceId,\n                deviceId: device_id,\n                devices: devices,\n                isInitializing: false,\n                status: device_id ? STATUS.READY : STATUS.IDLE\n              });\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.handleToggleMagnify = function () {\n      var magnifySliderOnHover = _this.props.magnifySliderOnHover;\n\n      if (magnifySliderOnHover) {\n        _this.updateState(function (previousState) {\n          return {\n            isMagnified: !previousState.isMagnified\n          };\n        });\n      }\n    };\n\n    _this.initializePlayer = function () {\n      var volume = _this.state.volume;\n      var _a = _this.props,\n          name = _a.name,\n          token = _a.token;\n\n      _this.updateState({\n        isInitializing: true\n      }); // @ts-ignore\n\n\n      _this.player = new window.Spotify.Player({\n        getOAuthToken: function (callback) {\n          callback(token);\n        },\n        name: name,\n        volume: volume\n      });\n\n      _this.player.addListener('ready', _this.handlePlayerStatus);\n\n      _this.player.addListener('not_ready', _this.handlePlayerStatus);\n\n      _this.player.addListener('player_state_changed', _this.handlePlayerStateChanges);\n\n      _this.player.addListener('initialization_error', function (error) {\n        return _this.handlePlayerErrors('initialization_error', error.message);\n      });\n\n      _this.player.addListener('authentication_error', function (error) {\n        return _this.handlePlayerErrors('authentication_error', error.message);\n      });\n\n      _this.player.addListener('account_error', function (error) {\n        return _this.handlePlayerErrors('account_error', error.message);\n      });\n\n      _this.player.addListener('playback_error', function (error) {\n        return _this.handlePlayerErrors('playback_error', error.message);\n      });\n\n      _this.player.connect();\n    };\n\n    _this.setAlbumImage = function (album) {\n      var width = Math.min.apply(Math, __spreadArray([], __read(album.images.map(function (d) {\n        return d.width;\n      }))));\n      var thumb = album.images.find(function (d) {\n        return d.width === width;\n      }) || {};\n      return thumb.url;\n    };\n\n    _this.setExternalDevice = function (id) {\n      _this.updateState({\n        currentDeviceId: id,\n        isPlaying: true\n      });\n    };\n\n    _this.setVolume = function (volume) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var token;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              token = this.props.token;\n              if (!this.isExternalPlayer) return [3\n              /*break*/\n              , 3];\n              return [4\n              /*yield*/\n              , setVolume(token, Math.round(volume * 100))];\n\n            case 1:\n              _a.sent();\n\n              return [4\n              /*yield*/\n              , this.syncDevice()];\n\n            case 2:\n              _a.sent();\n\n              return [3\n              /*break*/\n              , 5];\n\n            case 3:\n              if (!this.player) return [3\n              /*break*/\n              , 5];\n              return [4\n              /*yield*/\n              , this.player.setVolume(volume)];\n\n            case 4:\n              _a.sent();\n\n              _a.label = 5;\n\n            case 5:\n              this.updateState({\n                volume: volume\n              });\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.syncDevice = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var deviceId, token, player, track, error_7, state;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (!this.isActive) {\n                return [2\n                /*return*/\n                ];\n              }\n\n              deviceId = this.state.deviceId;\n              token = this.props.token;\n              _a.label = 1;\n\n            case 1:\n              _a.trys.push([1, 3,, 4]);\n\n              return [4\n              /*yield*/\n              , getPlaybackState(token)];\n\n            case 2:\n              player = _a.sent();\n              track = this.emptyTrack;\n\n              if (!player) {\n                throw new Error('No player');\n              }\n              /* istanbul ignore else */\n\n\n              if (player.item) {\n                track = {\n                  artists: player.item.artists.map(function (d) {\n                    return d.name;\n                  }).join(', '),\n                  durationMs: player.item.duration_ms,\n                  id: player.item.id,\n                  image: this.setAlbumImage(player.item.album),\n                  name: player.item.name,\n                  uri: player.item.uri\n                };\n              }\n\n              this.updateState({\n                error: '',\n                errorType: '',\n                isActive: true,\n                isPlaying: player.is_playing,\n                nextTracks: [],\n                previousTracks: [],\n                progressMs: player.item ? player.progress_ms : 0,\n                status: STATUS.READY,\n                track: track,\n                volume: parseVolume(player.device.volume_percent)\n              });\n              return [3\n              /*break*/\n              , 4];\n\n            case 3:\n              error_7 = _a.sent();\n              state = {\n                isActive: false,\n                isPlaying: false,\n                position: 0,\n                track: this.emptyTrack\n              };\n\n              if (deviceId) {\n                this.updateState(__assign({\n                  currentDeviceId: deviceId\n                }, state));\n                return [2\n                /*return*/\n                ];\n              }\n\n              this.updateState(__assign({\n                error: error_7.message,\n                errorType: 'player_status',\n                status: STATUS.ERROR\n              }, state));\n              return [3\n              /*break*/\n              , 4];\n\n            case 4:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.toggleOffset = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var _a, currentDeviceId, isPlaying, _b, offset, token, uris;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              _a = this.state, currentDeviceId = _a.currentDeviceId, isPlaying = _a.isPlaying;\n              _b = this.props, offset = _b.offset, token = _b.token, uris = _b.uris;\n              if (!(isPlaying && typeof offset === 'number' && Array.isArray(uris))) return [3\n              /*break*/\n              , 2];\n              return [4\n              /*yield*/\n              , play(token, {\n                deviceId: currentDeviceId,\n                offset: offset,\n                uris: uris\n              })];\n\n            case 1:\n              _c.sent();\n\n              _c.label = 2;\n\n            case 2:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.togglePlay = function (init) {\n      if (init === void 0) {\n        init = false;\n      }\n\n      return __awaiter(_this, void 0, void 0, function () {\n        var _a, currentDeviceId, isPlaying, needsUpdate, _b, offset, token, uris, shouldInitialize, playOptions, playerState, error_8;\n\n        var _this = this;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              _a = this.state, currentDeviceId = _a.currentDeviceId, isPlaying = _a.isPlaying, needsUpdate = _a.needsUpdate;\n              _b = this.props, offset = _b.offset, token = _b.token, uris = _b.uris;\n              shouldInitialize = init || needsUpdate;\n              playOptions = this.getPlayOptions(uris);\n              _c.label = 1;\n\n            case 1:\n              _c.trys.push([1, 12,, 13]);\n\n              if (!this.isExternalPlayer) return [3\n              /*break*/\n              , 6];\n              if (!!isPlaying) return [3\n              /*break*/\n              , 3];\n              return [4\n              /*yield*/\n              , play(token, __assign({\n                deviceId: currentDeviceId,\n                offset: offset\n              }, shouldInitialize ? playOptions : undefined))];\n\n            case 2:\n              _c.sent();\n\n              return [3\n              /*break*/\n              , 5];\n\n            case 3:\n              return [4\n              /*yield*/\n              , pause(token)];\n\n            case 4:\n              _c.sent();\n\n              this.updateState({\n                isPlaying: false\n              });\n              _c.label = 5;\n\n            case 5:\n              this.syncTimeout = window.setTimeout(function () {\n                _this.syncDevice();\n              }, 300);\n              return [3\n              /*break*/\n              , 11];\n\n            case 6:\n              if (!this.player) return [3\n              /*break*/\n              , 11];\n              return [4\n              /*yield*/\n              , this.player.getCurrentState()];\n\n            case 7:\n              playerState = _c.sent();\n              if (!(!playerState && !!(playOptions.context_uri || playOptions.uris) || shouldInitialize && playerState && playerState.paused)) return [3\n              /*break*/\n              , 9];\n              return [4\n              /*yield*/\n              , play(token, __assign({\n                deviceId: currentDeviceId,\n                offset: offset\n              }, shouldInitialize ? playOptions : undefined))];\n\n            case 8:\n              _c.sent();\n\n              return [3\n              /*break*/\n              , 11];\n\n            case 9:\n              return [4\n              /*yield*/\n              , this.player.togglePlay()];\n\n            case 10:\n              _c.sent();\n\n              _c.label = 11;\n\n            case 11:\n              if (needsUpdate) {\n                this.updateState({\n                  needsUpdate: false\n                });\n              }\n\n              return [3\n              /*break*/\n              , 13];\n\n            case 12:\n              error_8 = _c.sent(); // eslint-disable-next-line no-console\n\n              console.error(error_8);\n              return [3\n              /*break*/\n              , 13];\n\n            case 13:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.updateSeekBar = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var _a, progressMs, track, position, state, progress, position, error_9;\n\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              if (!this.isActive) {\n                return [2\n                /*return*/\n                ];\n              }\n\n              _a = this.state, progressMs = _a.progressMs, track = _a.track;\n              _b.label = 1;\n\n            case 1:\n              _b.trys.push([1, 5,, 6]);\n\n              if (!this.isExternalPlayer) return [3\n              /*break*/\n              , 2];\n              position = progressMs / track.durationMs;\n              position = Number(((Number.isFinite(position) ? position : 0) * 100).toFixed(1));\n              this.updateState({\n                position: position,\n                progressMs: progressMs + this.seekUpdateInterval\n              });\n              return [3\n              /*break*/\n              , 4];\n\n            case 2:\n              if (!this.player) return [3\n              /*break*/\n              , 4];\n              return [4\n              /*yield*/\n              , this.player.getCurrentState()];\n\n            case 3:\n              state = _b.sent();\n              /* istanbul ignore else */\n\n              if (state) {\n                progress = state.position;\n                position = Number((progress / state.track_window.current_track.duration_ms * 100).toFixed(1));\n                this.updateState({\n                  position: position,\n                  progressMs: progress + this.seekUpdateInterval\n                });\n              }\n\n              _b.label = 4;\n\n            case 4:\n              return [3\n              /*break*/\n              , 6];\n\n            case 5:\n              error_9 = _b.sent(); // eslint-disable-next-line no-console\n\n              console.error(error_9);\n              return [3\n              /*break*/\n              , 6];\n\n            case 6:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.updateState = function (state) {\n      if (state === void 0) {\n        state = {};\n      }\n\n      if (!_this.isActive) {\n        return;\n      }\n\n      _this.setState(state);\n    };\n\n    _this.state = {\n      currentDeviceId: '',\n      deviceId: '',\n      devices: [],\n      error: '',\n      errorType: '',\n      isActive: false,\n      isInitializing: false,\n      isMagnified: false,\n      isPlaying: false,\n      isSaved: false,\n      isUnsupported: false,\n      needsUpdate: false,\n      nextTracks: [],\n      playerPosition: 'bottom',\n      position: 0,\n      previousTracks: [],\n      progressMs: 0,\n      status: STATUS.IDLE,\n      track: _this.emptyTrack,\n      volume: parseVolume(props.initialVolume) || 1\n    };\n    _this.styles = getMergedStyles(props.styles);\n    return _this;\n  }\n\n  SpotifyWebPlayer.prototype.componentDidMount = function () {\n    var _a;\n\n    return __awaiter(this, void 0, void 0, function () {\n      var _b, top;\n\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            this.isActive = true;\n            _b = (((_a = this.ref.current) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect()) || {}).top, top = _b === void 0 ? 0 : _b;\n            this.updateState({\n              playerPosition: top > window.innerHeight / 2 ? 'bottom' : 'top',\n              status: STATUS.INITIALIZING\n            });\n\n            if (!window.onSpotifyWebPlaybackSDKReady) {\n              window.onSpotifyWebPlaybackSDKReady = this.initializePlayer;\n            } else {\n              this.initializePlayer();\n            }\n\n            return [4\n            /*yield*/\n            , loadSpotifyPlayer()];\n\n          case 1:\n            _c.sent();\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  SpotifyWebPlayer.prototype.componentDidUpdate = function (previousProps, previousState) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, currentDeviceId, deviceId, error, isInitializing, isPlaying, status, track, _b, autoPlay, callback, offset, playProp, showSaveIcon, syncExternalDevice, token, uris, isReady, changedURIs, playOptions, canPlay, shouldPlay, player;\n\n      var _this = this;\n\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            _a = this.state, currentDeviceId = _a.currentDeviceId, deviceId = _a.deviceId, error = _a.error, isInitializing = _a.isInitializing, isPlaying = _a.isPlaying, status = _a.status, track = _a.track;\n            _b = this.props, autoPlay = _b.autoPlay, callback = _b.callback, offset = _b.offset, playProp = _b.play, showSaveIcon = _b.showSaveIcon, syncExternalDevice = _b.syncExternalDevice, token = _b.token, uris = _b.uris;\n            isReady = previousState.status !== STATUS.READY && status === STATUS.READY;\n            changedURIs = Array.isArray(uris) ? !isEqualArray(previousProps.uris, uris) : previousProps.uris !== uris;\n            playOptions = this.getPlayOptions(uris);\n            canPlay = !!currentDeviceId && !!(playOptions.context_uri || playOptions.uris);\n            shouldPlay = changedURIs && isPlaying || !!(isReady && (autoPlay || playProp));\n            if (!(canPlay && shouldPlay)) return [3\n            /*break*/\n            , 2];\n            return [4\n            /*yield*/\n            , play(token, __assign({\n              deviceId: currentDeviceId,\n              offset: offset\n            }, playOptions))];\n\n          case 1:\n            _c.sent();\n            /* istanbul ignore else */\n\n\n            if (!isPlaying) {\n              this.updateState({\n                isPlaying: true\n              });\n            }\n\n            if (this.isExternalPlayer) {\n              this.syncTimeout = window.setTimeout(function () {\n                _this.syncDevice();\n              }, 600);\n            }\n\n            return [3\n            /*break*/\n            , 3];\n\n          case 2:\n            if (changedURIs && !isPlaying) {\n              this.updateState({\n                needsUpdate: true\n              });\n            }\n\n            _c.label = 3;\n\n          case 3:\n            if (previousState.status !== status) {\n              callback(__assign(__assign({}, this.state), {\n                type: TYPE.STATUS\n              }));\n            }\n\n            if (!(previousState.currentDeviceId !== currentDeviceId && currentDeviceId)) return [3\n            /*break*/\n            , 6];\n\n            if (!isReady) {\n              callback(__assign(__assign({}, this.state), {\n                type: TYPE.DEVICE\n              }));\n            }\n\n            return [4\n            /*yield*/\n            , this.toggleSyncInterval(this.isExternalPlayer)];\n\n          case 4:\n            _c.sent();\n\n            return [4\n            /*yield*/\n            , this.updateSeekBar()];\n\n          case 5:\n            _c.sent();\n\n            _c.label = 6;\n\n          case 6:\n            if (previousState.track.id !== track.id && track.id) {\n              callback(__assign(__assign({}, this.state), {\n                type: TYPE.TRACK\n              }));\n\n              if (showSaveIcon) {\n                this.updateState({\n                  isSaved: false\n                });\n              }\n            }\n\n            if (!(previousState.isPlaying !== isPlaying)) return [3\n            /*break*/\n            , 8];\n            this.toggleProgressBar();\n            return [4\n            /*yield*/\n            , this.toggleSyncInterval(this.isExternalPlayer)];\n\n          case 7:\n            _c.sent();\n\n            callback(__assign(__assign({}, this.state), {\n              type: TYPE.PLAYER\n            }));\n            _c.label = 8;\n\n          case 8:\n            if (token && previousProps.token !== token) {\n              this.hasNewToken = true;\n\n              if (!isInitializing) {\n                this.initializePlayer();\n              } else {\n                this.hasNewToken = true;\n              }\n            }\n\n            if (!(previousProps.play !== playProp && playProp !== isPlaying)) return [3\n            /*break*/\n            , 10];\n            return [4\n            /*yield*/\n            , this.togglePlay(!track.id)];\n\n          case 9:\n            _c.sent();\n\n            _c.label = 10;\n\n          case 10:\n            if (!(previousProps.offset !== offset)) return [3\n            /*break*/\n            , 12];\n            return [4\n            /*yield*/\n            , this.toggleOffset()];\n\n          case 11:\n            _c.sent();\n\n            _c.label = 12;\n\n          case 12:\n            if (!(previousState.isInitializing && !isInitializing)) return [3\n            /*break*/\n            , 14];\n\n            if (error === 'authentication_error' && this.hasNewToken) {\n              this.hasNewToken = false;\n              this.initializePlayer();\n            }\n\n            if (!(syncExternalDevice && !uris)) return [3\n            /*break*/\n            , 14];\n            return [4\n            /*yield*/\n            , getPlaybackState(token)];\n\n          case 13:\n            player = _c.sent();\n            /* istanbul ignore else */\n\n            if (player && player.is_playing && player.device.id !== deviceId) {\n              this.setExternalDevice(player.device.id);\n            }\n\n            _c.label = 14;\n\n          case 14:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  SpotifyWebPlayer.prototype.componentWillUnmount = function () {\n    this.isActive = false;\n    /* istanbul ignore else */\n\n    if (this.player) {\n      this.player.disconnect();\n    }\n\n    clearInterval(this.playerSyncInterval);\n    clearInterval(this.playerProgressInterval);\n    clearTimeout(this.syncTimeout);\n  };\n\n  Object.defineProperty(SpotifyWebPlayer.prototype, \"isExternalPlayer\", {\n    get: function () {\n      var _a = this.state,\n          currentDeviceId = _a.currentDeviceId,\n          deviceId = _a.deviceId,\n          status = _a.status;\n      return currentDeviceId && currentDeviceId !== deviceId || status === STATUS.UNSUPPORTED;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  SpotifyWebPlayer.prototype.initializeDevices = function (id) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, persistDeviceSelection, token, devices, currentDeviceId, savedDeviceId_1;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            _a = this.props, persistDeviceSelection = _a.persistDeviceSelection, token = _a.token;\n            return [4\n            /*yield*/\n            , getDevices(token)];\n\n          case 1:\n            devices = _b.sent().devices;\n            currentDeviceId = id;\n\n            if (persistDeviceSelection) {\n              savedDeviceId_1 = sessionStorage.getItem('rswpDeviceId');\n              /* istanbul ignore else */\n\n              if (!savedDeviceId_1 || !devices.some(function (d) {\n                return d.id === savedDeviceId_1;\n              })) {\n                sessionStorage.setItem('rswpDeviceId', currentDeviceId);\n              } else {\n                currentDeviceId = savedDeviceId_1;\n              }\n            }\n\n            return [2\n            /*return*/\n            , {\n              currentDeviceId: currentDeviceId,\n              devices: devices\n            }];\n        }\n      });\n    });\n  };\n\n  SpotifyWebPlayer.prototype.toggleSyncInterval = function (shouldSync) {\n    return __awaiter(this, void 0, void 0, function () {\n      var syncExternalDeviceInterval, error_10;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            syncExternalDeviceInterval = this.props.syncExternalDeviceInterval;\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 4,, 5]);\n\n            if (!(this.isExternalPlayer && shouldSync && !this.playerSyncInterval)) return [3\n            /*break*/\n            , 3];\n            return [4\n            /*yield*/\n            , this.syncDevice()];\n\n          case 2:\n            _a.sent();\n\n            clearInterval(this.playerSyncInterval);\n            this.playerSyncInterval = window.setInterval(this.syncDevice, syncExternalDeviceInterval * 1000);\n            _a.label = 3;\n\n          case 3:\n            if ((!shouldSync || !this.isExternalPlayer) && this.playerSyncInterval) {\n              clearInterval(this.playerSyncInterval);\n              this.playerSyncInterval = undefined;\n            }\n\n            return [3\n            /*break*/\n            , 5];\n\n          case 4:\n            error_10 = _a.sent(); // eslint-disable-next-line no-console\n\n            console.error(error_10);\n            return [3\n            /*break*/\n            , 5];\n\n          case 5:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  SpotifyWebPlayer.prototype.toggleProgressBar = function () {\n    var isPlaying = this.state.isPlaying;\n    /* istanbul ignore else */\n\n    if (isPlaying) {\n      /* istanbul ignore else */\n      if (!this.playerProgressInterval) {\n        this.playerProgressInterval = window.setInterval(this.updateSeekBar, this.seekUpdateInterval);\n      }\n    } else if (this.playerProgressInterval) {\n      clearInterval(this.playerProgressInterval);\n      this.playerProgressInterval = undefined;\n    }\n  };\n\n  SpotifyWebPlayer.prototype.render = function () {\n    var _a = this.state,\n        currentDeviceId = _a.currentDeviceId,\n        deviceId = _a.deviceId,\n        devices = _a.devices,\n        error = _a.error,\n        errorType = _a.errorType,\n        isActive = _a.isActive,\n        isMagnified = _a.isMagnified,\n        isPlaying = _a.isPlaying,\n        isUnsupported = _a.isUnsupported,\n        nextTracks = _a.nextTracks,\n        playerPosition = _a.playerPosition,\n        position = _a.position,\n        previousTracks = _a.previousTracks,\n        status = _a.status,\n        track = _a.track,\n        volume = _a.volume;\n    var _b = this.props,\n        name = _b.name,\n        showSaveIcon = _b.showSaveIcon,\n        token = _b.token,\n        updateSavedStatus = _b.updateSavedStatus;\n    var isReady = [STATUS.READY, STATUS.UNSUPPORTED].indexOf(status) >= 0;\n    var isPlaybackError = errorType === 'playback_error';\n    var output = React.createElement(Loader, {\n      styles: this.styles\n    });\n    var info;\n\n    if (isPlaybackError) {\n      info = React.createElement(\"p\", null, error);\n    }\n\n    if (isReady) {\n      /* istanbul ignore else */\n      if (!info) {\n        info = React.createElement(Info, {\n          isActive: isActive,\n          onFavoriteStatusChange: this.handleFavoriteStatusChange,\n          showSaveIcon: showSaveIcon,\n          styles: this.styles,\n          token: token,\n          track: track,\n          updateSavedStatus: updateSavedStatus\n        });\n      }\n\n      output = React.createElement(React.Fragment, null, React.createElement(\"div\", null, info), React.createElement(Controls, {\n        isExternalDevice: this.isExternalPlayer,\n        isPlaying: isPlaying,\n        nextTracks: nextTracks,\n        onClickNext: this.handleClickNext,\n        onClickPrevious: this.handleClickPrevious,\n        onClickTogglePlay: this.handleClickTogglePlay,\n        previousTracks: previousTracks,\n        styles: this.styles\n      }), React.createElement(Actions, {\n        currentDeviceId: currentDeviceId,\n        deviceId: deviceId,\n        devices: devices,\n        isDevicesOpen: isUnsupported && !deviceId,\n        onClickDevice: this.handleClickDevice,\n        playerPosition: playerPosition,\n        setVolume: this.setVolume,\n        styles: this.styles,\n        volume: volume\n      }));\n    }\n\n    if (status === STATUS.ERROR) {\n      output = React.createElement(ErrorMessage, {\n        styles: this.styles\n      }, name, \": \", error);\n    }\n\n    return React.createElement(Player, {\n      ref: this.ref,\n      styles: this.styles\n    }, isReady && React.createElement(Slider, {\n      isMagnified: isMagnified,\n      onChangeRange: this.handleChangeRange,\n      onToggleMagnify: this.handleToggleMagnify,\n      position: position,\n      styles: this.styles\n    }), React.createElement(Content, {\n      styles: this.styles\n    }, output));\n  }; // eslint-disable-next-line react/static-property-placement\n\n\n  SpotifyWebPlayer.defaultProps = {\n    callback: function () {\n      return undefined;\n    },\n    magnifySliderOnHover: false,\n    name: 'Spotify Web Player',\n    showSaveIcon: false,\n    syncExternalDeviceInterval: 5,\n    syncExternalDevice: false\n  };\n  return SpotifyWebPlayer;\n}(React.PureComponent);\n\nexport { STATUS, TYPE };\nexport * from './types';\nexport default SpotifyWebPlayer;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;AACA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,OAAOC,OAAP,MAAoB,aAApB;AAEA,OAAOC,OAAP,MAAoB,sBAApB;AACA,OAAOC,OAAP,MAAoB,sBAApB;AACA,OAAOC,QAAP,MAAqB,uBAArB;AACA,OAAOC,YAAP,MAAyB,2BAAzB;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,SACEC,UADF,EAEEC,gBAFF,EAGEC,IAHF,EAIEC,KAJF,EAKEC,IALF,EAMEC,QANF,EAOEC,IAPF,EAQEC,SARF,EASEC,SATF,QAUO,WAVP;AAWA,SAASC,eAAT,QAAgC,UAAhC;AAgBA,SACEC,iBADF,EAEEC,YAFF,EAGEC,iBAHF,EAIEC,WAJF,EAKEC,KALF,EAMEC,MANF,EAOEC,IAPF,EAQEC,WARF,QASO,SATP;;AAWA;AAAA;AAAA;AAA+BC;;AA0D7B,4BAAYC,KAAZ,EAAwB;AAAxB,gBACEC,kBAAMD,KAAN,KAAY,IADd;;AAzDQE,qBAAW,KAAX;AACAA,uBAAa;AACnBC,aAAO,EAAE,EADU;AAEnBC,gBAAU,EAAE,CAFO;AAGnBC,QAAE,EAAE,EAHe;AAInBC,WAAK,EAAE,EAJY;AAKnBC,UAAI,EAAE,EALa;AAMnBC,SAAG,EAAE;AANc,KAAb;AASAN,2BAAiB9B,OAAO,CAAC,UAACqC,IAAD,EAAK;AACpC,UAAMC,WAAW,GAAgB;AAC/BC,mBAAW,EAAEC,SADkB;AAE/BC,YAAI,EAAED;AAFyB,OAAjC;AAKA;;AACA,UAAIH,IAAJ,EAAU;AACR,YAAMK,GAAG,GAAGC,KAAK,CAACC,OAAN,CAAcP,IAAd,IAAsBA,IAAtB,GAA6B,CAACA,IAAD,CAAzC;;AAEA,YAAI,CAACK,GAAG,CAACG,KAAJ,CAAU,aAAC;AAAI,4BAAW,CAACC,CAAD,CAAX;AAAc,SAA7B,CAAL,EAAqC;AACnC;AACAC,iBAAO,CAACC,KAAR,CAAc,aAAd;AAEA,iBAAOV,WAAP;AACD;;AAED,YAAII,GAAG,CAACO,IAAJ,CAAS,aAAC;AAAI,kCAAiB,CAACH,CAAD,CAAjB,KAAyB,OAAzB;AAAgC,SAA9C,CAAJ,EAAqD;AACnD,cAAI,CAACJ,GAAG,CAACG,KAAJ,CAAU,aAAC;AAAI,oCAAiB,CAACC,CAAD,CAAjB,KAAyB,OAAzB;AAAgC,WAA/C,CAAL,EAAuD;AACrD;AACAC,mBAAO,CAACG,IAAR,CAAa,4CAAb;AACD;;AAEDZ,qBAAW,CAACG,IAAZ,GAAmBC,GAAG,CAACS,MAAJ,CAAW,aAAC;AAAI,8BAAW,CAACL,CAAD,CAAX,IAAkB3B,iBAAiB,CAAC2B,CAAD,CAAjB,KAAyB,OAA3C;AAAkD,WAAlE,CAAnB;AACD,SAPD,MAOO;AACL,cAAIJ,GAAG,CAACU,MAAJ,GAAa,CAAjB,EAAoB;AAClB;AACAL,mBAAO,CAACG,IAAR,CAAa,kEAAb;AACD,WAJI,CAML;;;AACAZ,qBAAW,CAACC,WAAZ,GAA0BG,GAAG,CAAC,CAAD,CAA7B;AACD;AACF;;AAED,aAAOJ,WAAP;AACD,KApC+B,CAAxB;AAsCAR,wBAAc,KAAd;AAIAA,gBAAM/B,KAAK,CAACsD,SAAN,EAAN;AACAvB,+BAAqB,GAArB;;AAkMAA,8BAAoB,UAAOwB,QAAP,EAAuB;AAAA;;;;;;AACzCC,mBAAK,GAAK,KAAKC,KAAL,CAAUD,KAApB;AACFE,mBAAsB,KAAK7B,KAA3B,EAAE8B,QAAQ,cAAV,EAAYC,KAAK,WAAjB;AACFC,sBAAQ,GAAG,CAAX;;;;;;AAGIC,wBAAU,GAAGP,QAAQ,GAAG,GAAxB;mBAEF,KAAKQ,kBAAL;AAAA;AAAA;AACFF,sBAAQ,GAAGG,IAAI,CAACxC,KAAL,CAAWgC,KAAK,CAACvB,UAAN,GAAmB6B,UAA9B,CAAX;AACA;AAAA;AAAA,gBAAM9C,IAAI,CAAC4C,KAAD,EAAQC,QAAR,CAAV;;;AAAAI;;AAEA,mBAAKC,WAAL,CAAiB;AACfX,wBAAQ,UADO;AAEfY,0BAAU,EAAEN;AAFG,eAAjB;;;;;;mBAIS,KAAKO,QAAL;AAAA;AAAA;AACM;AAAA;AAAA,gBAAM,KAAKA,MAAL,CAAYC,eAAZ,EAAN;;;AAATZ,mBAAK,GAAIQ,SAAT;mBAEFR;AAAA;AAAA;AACFI,sBAAQ,GAAGG,IAAI,CAACxC,KAAL,CAAWiC,KAAK,CAACa,YAAN,CAAmBC,aAAnB,CAAiCC,WAAjC,GAA+CV,UAA1D,CAAX;AACA;AAAA;AAAA,gBAAM,KAAKM,MAAL,CAAYpD,IAAZ,CAAiB6C,QAAjB,CAAN;;;AAAAI;;AAEA,mBAAKC,WAAL,CAAiB;AACfX,wBAAQ,UADO;AAEfY,0BAAU,EAAEN;AAFG,eAAjB;;;;;;AAKA,mBAAKK,WAAL,CAAiB;AAAEX,wBAAQ,EAAE;AAAZ,eAAjB;;;;AAIJ,kBAAII,QAAJ,EAAc;AACZA,wBAAQ,uBACH,KAAKF,KADF,GACO;AACbgB,sBAAI,EAAE/C,IAAI,CAACgD;AADE,iBADP,EAAR;AAID;;;;;;;mCAED;;AACA1B,qBAAO,CAACC,KAAR,CAAc0B,OAAd;;;;;;;;;;;OAxC+C;AA0ClD,KA1CO;;AA4CA5C,kCAAwB;AAAA;;;;;AACtB6C,sBAAQ,GAAK,KAAKnB,KAAL,CAAUmB,QAAvB;;;;;;AAGN;AAAA;AAAA,gBAAM,KAAKC,UAAL,CAAgB,CAAC,KAAKd,gBAAN,IAA0B,CAACa,QAA3C,CAAN;;;AAAAlB;;;;;;;mCAEA;;AACAV,qBAAO,CAACC,KAAR,CAAc6B,OAAd;;;;;;;;;;;OAP4B;AAS/B,KATO;;AAWA/C,gCAAsB;AAAA;;;;;;;;;;mBAGtB,KAAKgC,kBAAL;AAAA;AAAA;AACMH,mBAAK,GAAK,KAAK/B,KAAL,CAAU+B,KAApB;AAER;AAAA;AAAA,gBAAM7C,QAAQ,CAAC6C,KAAD,CAAd;;;AAAAF;;AACA,mBAAKqB,WAAL,GAAmBC,MAAM,CAACC,UAAP,CAAkB;AACnClD,qBAAI,CAACmD,UAAL;AACD,eAFkB,EAEhB,GAFgB,CAAnB;;;;;;mBAGS,KAAKd,QAAL;AAAA;AAAA;AACT;AAAA;AAAA,gBAAM,KAAKA,MAAL,CAAYe,aAAZ,EAAN;;;AAAAzB;;;;;;;;;;mCAGF;;AACAV,qBAAO,CAACC,KAAR,CAAcmC,OAAd;;;;;;;;;;;OAf0B;AAiB7B,KAjBO;;AAmBArD,4BAAkB;AAAA;;;;;;;;;;mBAGlB,KAAKgC,kBAAL;AAAA;AAAA;AACMH,mBAAK,GAAK,KAAK/B,KAAL,CAAU+B,KAApB;AAER;AAAA;AAAA,gBAAMhD,IAAI,CAACgD,KAAD,CAAV;;;AAAAF;;AACA,mBAAKqB,WAAL,GAAmBC,MAAM,CAACC,UAAP,CAAkB;AACnClD,qBAAI,CAACmD,UAAL;AACD,eAFkB,EAEhB,GAFgB,CAAnB;;;;;;mBAGS,KAAKd,QAAL;AAAA;AAAA;AACT;AAAA;AAAA,gBAAM,KAAKA,MAAL,CAAYiB,SAAZ,EAAN;;;AAAA3B;;;;;;;;;;mCAGF;;AACAV,qBAAO,CAACC,KAAR,CAAcqC,OAAd;;;;;;;;;;;OAfsB;AAiBzB,KAjBO;;AAmBAvD,8BAAoB,UAAOwD,QAAP,EAAuB;AAAA;;;;;;AACzCC,2BAAa,GAAK,KAAK/B,KAAL,CAAU+B,aAA5B;AACF9B,mBAA8C,KAAK7B,KAAnD,EAAE4D,QAAQ,cAAV,EAAYC,sBAAsB,4BAAlC,EAAoC9B,KAAK,WAAzC;AAEN,mBAAKM,WAAL,CAAiB;AAAEyB,+BAAe,EAAEJ;AAAnB,eAAjB;;;;;;AAGE;AAAA;AAAA,gBAAMtE,SAAS,CAAC2C,KAAD,EAAQ2B,QAAR,CAAf;;;AAAAtB;AAEA;;;AACA,kBAAIyB,sBAAJ,EAA4B;AAC1BE,8BAAc,CAACC,OAAf,CAAuB,cAAvB,EAAuCN,QAAvC;AACD;;mBAGGC;AAAA;AAAA;AACF;AAAA;AAAA,gBAAM,KAAKN,UAAL,EAAN;;;AAAAjB;;AAEoC;AAAA;AAAA,gBAAMtD,gBAAgB,CAACiD,KAAD,CAAtB;;;AAA9BQ,oBAAM,GAAwBH,SAA9B;oBAEFG,MAAM,IAAI,CAACA,MAAM,CAAC0B,UAAlB,IAAgCL,WAAhC;AAAA;AAAA;AACF;AAAA;AAAA,gBAAM,KAAKZ,UAAL,CAAgB,IAAhB,CAAN;;;AAAAZ;;;;;;;;;;mCAIJ;;AACAjB,qBAAO,CAACC,KAAR,CAAc8C,OAAd;;;;;;;;;;;OA1B+C;AA4BlD,KA5BO;;AA8BAhE,uCAA6B,UAACiE,MAAD,EAAgB;AAC3C,iBAAO,GAAKjE,KAAI,CAAC0B,KAAL,CAAUwC,OAAtB;AACA,kBAAQ,GAAKlE,KAAI,CAACF,KAAL,CAAU8B,QAAvB;;AAER5B,WAAI,CAACmC,WAAL,CAAiB;AAAE+B,eAAO,EAAED;AAAX,OAAjB;AAEA;;;AACA,UAAIC,OAAO,KAAKD,MAAhB,EAAwB;AACtBrC,gBAAS,6CAEF5B,KAAI,CAAC0B,KAFH,GAEQ;AACbwC,iBAAO,EAAED;AADI,SAFR,IAGU;AAEjBvB,cAAI,EAAE/C,IAAI,CAACwE;AAFM,SAHV,EAAT;AAOD;AACF,KAhBO;;AAkBAnE,+BAAqB,UAAO0C,IAAP,EAAqB0B,OAArB,EAAoC;AAAA;;;;;;;;AACvDH,oBAAM,GAAK,KAAKvC,KAAL,CAAUuC,MAArB;AACFI,6BAAe,GAAG3B,IAAI,KAAK,gBAA3B;AACA4B,mCAAqB,GAAG5B,IAAI,KAAK,sBAAjC;AACF6B,wBAAU,GAAGN,MAAb;AACAO,qBAAO,GAAoB,EAA3B;oBAEA,KAAKnC,MAAL,IAAe,CAACgC,kBAAhB;AAAA;AAAA;AACF;AAAA;AAAA,gBAAM,KAAKhC,MAAL,CAAYoC,UAAZ,EAAN;;;AAAAvC;;;;;mBAGEoC;AAAA;AAAA;AACFC,wBAAU,GAAG7E,MAAM,CAACgF,WAApB;AAEQ7C,mBAAK,GAAK,KAAK/B,KAAL,CAAU+B,KAApB;AAEY;AAAA;AAAA,gBAAMlD,UAAU,CAACkD,KAAD,CAAhB;;;AAAjBF,mBAAiBO,UAAuBsC,OAAxC,SAAO,mBAAG,EAAH,GAAK7C,EAAf;;;;AAGF,kBAAI,CAAC2C,qBAAD,IAA0B,CAACD,eAA/B,EAAgD;AAC9CE,0BAAU,GAAG7E,MAAM,CAACiF,KAApB;AACD;;AAED,mBAAKxC,WAAL,CAAiB;AACfqC,uBAAO,SADQ;AAEftD,qBAAK,EAAEkD,OAFQ;AAGfQ,yBAAS,EAAElC,IAHI;AAIfmC,8BAAc,EAAE,KAJD;AAKfpB,6BAAa,EAAEa,qBALA;AAMfL,sBAAM,EAAEM;AANO,eAAjB;;;;;;OAvB+D;AA+BhE,KA/BO;;AAiCAvE,qCAA2B,UAAO0B,KAAP,EAAqC;AAAA;;;;;;;;mBAGhEA;AAAA;AAAA;AAEAoD,oBAAM,GAOJpD,KAAK,OAPP,EACAF,QAAQ,GAMNE,KAAK,SAPP,EAEAC,KAKED,KAAK,aAPP,EAGEQ,qBAHF,EAGmB6C,KAAK,WAHxB,EAG0B9E,OAAO,aAHjC,EAGmCwC,WAAW,iBAH9C,EAGgDtC,EAAE,QAHlD,EAGoD6E,gBAHpD,EAG0D1E,GAAG,SAH7D,EAIE2E,WAAW,iBAJb,EAKEC,eAAe,qBALjB;AASIC,uBAAS,GAAG,CAACL,MAAb;AACS;AAAA;AAAA,gBAAM,KAAKzC,MAAL,CAAa+C,SAAb,EAAN;;;AAATC,oBAAM,GAAGC,SAAT;AACA7D,mBAAK,GAAG;AACZxB,uBAAO,EAAEA,OAAO,CAACsF,GAAR,CAAY,aAAC;AAAI,0BAAC,CAAClF,IAAF;AAAM,iBAAvB,EAAyBmF,IAAzB,CAA8B,IAA9B,CADG;AAEZtF,0BAAU,EAAEuC,WAFA;AAGZtC,kBAAE,IAHU;AAIZC,qBAAK,EAAE,KAAKqF,aAAL,CAAmBV,KAAnB,CAJK;AAKZ1E,oBAAI,QALQ;AAMZC,mBAAG;AANS,eAAR;AAQFoF,wBAAU,SAAV;;AAEJ,kBAAIlE,QAAQ,KAAK,CAAjB,EAAoB;AAClBkE,0BAAU,GAAG;AACXC,4BAAU,EAAEV,WADD;AAEXzD,0BAAQ,EAAE,CAFC;AAGXoE,gCAAc,EAAEV,eAHL;AAIXzD,uBAAK;AAJM,iBAAb;AAMD;;AAED,mBAAKU,WAAL,CAAgB0D;AACd3E,qBAAK,EAAE,EADO;AAEd0D,yBAAS,EAAE,EAFG;AAGd/B,wBAAQ,EAAE,IAHI;AAIdsC,yBAAS,WAJK;AAKd/C,0BAAU,EAAEZ,QALE;AAMd6D,sBAAM,EAAE5F,KAAK,CAAC4F,MAAD;AANC,iBAOXK,UAPW,CAAhB;;;;;;mBASS,KAAK1D,kBAAL;AAAA;AAAA;AACT;AAAA;AAAA,gBAAM,KAAKmB,UAAL,EAAN;;;AAAAmC;;;;;;;AAEA,mBAAKnD,WAAL,CAAiB;AACfU,wBAAQ,EAAE,KADK;AAEfsC,yBAAS,EAAE,KAFI;AAGfQ,0BAAU,EAAE,EAHG;AAIfnE,wBAAQ,EAAE,CAJK;AAKfoE,8BAAc,EAAE,EALD;AAMfnE,qBAAK,EAAE;AACLxB,yBAAO,EAAE,EADJ;AAELC,4BAAU,EAAE,CAFP;AAGLC,oBAAE,EAAE,EAHC;AAILC,uBAAK,EAAE,EAJF;AAKLC,sBAAI,EAAE,EALD;AAMLC,qBAAG,EAAE;AANA;AANQ,eAAjB;;;;;;;;;mCAiBF;;AACAW,qBAAO,CAACC,KAAR,CAAc4E,OAAd;;;;;;;;;;;OAjEoE;AAmEvE,KAnEO;;AAqEA9F,+BAAqB,UAAO2B,EAAP,EAAsC;UAA7BoE,SAAS;;;;;;;AACR;AAAA;AAAA,gBAAM,KAAKC,iBAAL,CAAuBD,SAAvB,CAAN;;;AAA/B7D,mBAA+BoD,SAA/B,EAAE1B,eAAe,qBAAjB,EAAmBY,OAAO,aAA1B;AAEN,mBAAKrC,WAAL,CAAiB;AACfyB,+BAAe,iBADA;AAEfJ,wBAAQ,EAAEuC,SAFK;AAGfvB,uBAAO,SAHQ;AAIfK,8BAAc,EAAE,KAJD;AAKfZ,sBAAM,EAAE8B,SAAS,GAAGrG,MAAM,CAACuG,KAAV,GAAkBvG,MAAM,CAACwG;AAL3B,eAAjB;;;;;;;AAOD,KAVO;;AAYAlG,gCAAsB;AACpB,8BAAoB,GAAKA,KAAI,CAACF,KAAL,CAAUqG,oBAAnC;;AAER,UAAIA,oBAAJ,EAA0B;AACxBnG,aAAI,CAACmC,WAAL,CAAiB,UAACiE,aAAD,EAAqB;AACpC,iBAAO;AAAEC,uBAAW,EAAE,CAACD,aAAa,CAACC;AAA9B,WAAP;AACD,SAFD;AAGD;AACF,KARO;;AA6BArG,6BAAmB;AACjB,gBAAM,GAAKA,KAAI,CAAC0B,KAAL,CAAU2D,MAArB;AACF,eAAkBrF,KAAI,CAACF,KAAvB;AAAA,UAAEO,IAAI,UAAN;AAAA,UAAQwB,KAAK,WAAb;;AAEN7B,WAAI,CAACmC,WAAL,CAAiB;AAAE0C,sBAAc,EAAE;AAAlB,OAAjB,EAJyB,CAMzB;;;AACA7E,WAAI,CAACqC,MAAL,GAAc,IAAIY,MAAM,CAACqD,OAAP,CAAe7H,MAAnB,CAA0B;AACtC8H,qBAAa,EAAE,UAAC3E,QAAD,EAAgC;AAC7CA,kBAAQ,CAACC,KAAD,CAAR;AACD,SAHqC;AAItCxB,YAAI,MAJkC;AAKtCgF,cAAM;AALgC,OAA1B,CAAd;;AAQArF,WAAI,CAACqC,MAAL,CAAYmE,WAAZ,CAAwB,OAAxB,EAAiCxG,KAAI,CAACyG,kBAAtC;;AACAzG,WAAI,CAACqC,MAAL,CAAYmE,WAAZ,CAAwB,WAAxB,EAAqCxG,KAAI,CAACyG,kBAA1C;;AACAzG,WAAI,CAACqC,MAAL,CAAYmE,WAAZ,CAAwB,sBAAxB,EAAgDxG,KAAI,CAAC0G,wBAArD;;AACA1G,WAAI,CAACqC,MAAL,CAAYmE,WAAZ,CAAwB,sBAAxB,EAAgD,UAACtF,KAAD,EAAwB;AACtE,oBAAI,CAACyF,kBAAL,CAAwB,sBAAxB,EAAgDzF,KAAK,CAACkD,OAAtD;AAA8D,OADhE;;AAGApE,WAAI,CAACqC,MAAL,CAAYmE,WAAZ,CAAwB,sBAAxB,EAAgD,UAACtF,KAAD,EAAwB;AACtE,oBAAI,CAACyF,kBAAL,CAAwB,sBAAxB,EAAgDzF,KAAK,CAACkD,OAAtD;AAA8D,OADhE;;AAGApE,WAAI,CAACqC,MAAL,CAAYmE,WAAZ,CAAwB,eAAxB,EAAyC,UAACtF,KAAD,EAAwB;AAC/D,oBAAI,CAACyF,kBAAL,CAAwB,eAAxB,EAAyCzF,KAAK,CAACkD,OAA/C;AAAuD,OADzD;;AAGApE,WAAI,CAACqC,MAAL,CAAYmE,WAAZ,CAAwB,gBAAxB,EAA0C,UAACtF,KAAD,EAAwB;AAChE,oBAAI,CAACyF,kBAAL,CAAwB,gBAAxB,EAA0CzF,KAAK,CAACkD,OAAhD;AAAwD,OAD1D;;AAIApE,WAAI,CAACqC,MAAL,CAAYuE,OAAZ;AACD,KAhCO;;AAkCA5G,0BAAgB,UAAC+E,KAAD,EAAwB;AAC9C,UAAM8B,KAAK,GAAG5E,IAAI,CAAC6E,GAAL,CAAQC,KAAR,OAAIC,yBAAQjC,KAAK,CAACkC,MAAN,CAAa1B,GAAb,CAAiB,aAAC;AAAI,gBAAC,CAACsB,KAAF;AAAO,OAA7B,CAAR,EAAJ,CAAd;AACA,UAAMK,KAAK,GACTnC,KAAK,CAACkC,MAAN,CAAaE,IAAb,CAAkB,aAAC;AAAI,gBAAC,CAACN,KAAF,KAAYA,KAAZ;AAAiB,OAAxC,KAA8C,EADhD;AAGA,aAAOK,KAAK,CAACE,GAAb;AACD,KANO;;AAQApH,8BAAoB,UAACG,EAAD,EAAW;AACrCH,WAAI,CAACmC,WAAL,CAAiB;AAAEyB,uBAAe,EAAEzD,EAAnB;AAAuBgF,iBAAS,EAAE;AAAlC,OAAjB;AACD,KAFO;;AAIAnF,sBAAY,UAAOqF,MAAP,EAAqB;AAAA;;;;;AAC/BxD,mBAAK,GAAK,KAAK/B,KAAL,CAAU+B,KAApB;mBAGJ,KAAKG,kBAAL;AAAA;AAAA;AACF;AAAA;AAAA,gBAAM7C,SAAS,CAAC0C,KAAD,EAAQI,IAAI,CAACxC,KAAL,CAAW4F,MAAM,GAAG,GAApB,CAAR,CAAf;;;AAAA1D;;AACA;AAAA;AAAA,gBAAM,KAAKwB,UAAL,EAAN;;;AAAAxB;;;;;;;mBACS,KAAKU,QAAL;AAAA;AAAA;AACT;AAAA;AAAA,gBAAM,KAAKA,MAAL,CAAYlD,SAAZ,CAAsBkG,MAAtB,CAAN;;;AAAA1D;;;;;AAGF,mBAAKQ,WAAL,CAAiB;AAAEkD,sBAAM;AAAR,eAAjB;;;;;;OAXuC;AAYxC,KAZO;;AAcArF,uBAAa;AAAA;;;;;AACnB,kBAAI,CAAC,KAAK6C,QAAV,EAAoB;AAClB;AAAA;AAAA;AACD;;AAEOW,sBAAQ,GAAK,KAAK9B,KAAL,CAAU8B,QAAvB;AACA3B,mBAAK,GAAK,KAAK/B,KAAL,CAAU+B,KAApB;;;;;;AAG8B;AAAA;AAAA,gBAAMjD,gBAAgB,CAACiD,KAAD,CAAtB;;;AAA9BQ,oBAAM,GAAwBV,SAA9B;AACFF,mBAAK,GAAG,KAAK4F,UAAb;;AAEJ,kBAAI,CAAChF,MAAL,EAAa;AACX,sBAAM,IAAIiF,KAAJ,CAAU,WAAV,CAAN;AACD;AAED;;;AACA,kBAAIjF,MAAM,CAACkF,IAAX,EAAiB;AACf9F,qBAAK,GAAG;AACNxB,yBAAO,EAAEoC,MAAM,CAACkF,IAAP,CAAYtH,OAAZ,CAAoBsF,GAApB,CAAwB,aAAC;AAAI,4BAAC,CAAClF,IAAF;AAAM,mBAAnC,EAAqCmF,IAArC,CAA0C,IAA1C,CADH;AAENtF,4BAAU,EAAEmC,MAAM,CAACkF,IAAP,CAAY9E,WAFlB;AAGNtC,oBAAE,EAAEkC,MAAM,CAACkF,IAAP,CAAYpH,EAHV;AAINC,uBAAK,EAAE,KAAKqF,aAAL,CAAmBpD,MAAM,CAACkF,IAAP,CAAYxC,KAA/B,CAJD;AAKN1E,sBAAI,EAAEgC,MAAM,CAACkF,IAAP,CAAYlH,IALZ;AAMNC,qBAAG,EAAE+B,MAAM,CAACkF,IAAP,CAAYjH;AANX,iBAAR;AAQD;;AAED,mBAAK6B,WAAL,CAAiB;AACfjB,qBAAK,EAAE,EADQ;AAEf0D,yBAAS,EAAE,EAFI;AAGf/B,wBAAQ,EAAE,IAHK;AAIfsC,yBAAS,EAAE9C,MAAM,CAAC0B,UAJH;AAKf4B,0BAAU,EAAE,EALG;AAMfC,8BAAc,EAAE,EAND;AAOfxD,0BAAU,EAAEC,MAAM,CAACkF,IAAP,GAAclF,MAAM,CAACmF,WAArB,GAAmC,CAPhC;AAQfvD,sBAAM,EAAEvE,MAAM,CAACuG,KARA;AASfxE,qBAAK,OATU;AAUf4D,sBAAM,EAAE7F,WAAW,CAAC6C,MAAM,CAACoF,MAAP,CAAcC,cAAf;AAVJ,eAAjB;;;;;;;AAaMhG,mBAAK,GAAG;AACZmB,wBAAQ,EAAE,KADE;AAEZsC,yBAAS,EAAE,KAFC;AAGZ3D,wBAAQ,EAAE,CAHE;AAIZC,qBAAK,EAAE,KAAK4F;AAJA,eAAR;;AAON,kBAAI7D,QAAJ,EAAc;AACZ,qBAAKrB,WAAL,CAAgB0D;AACdjC,iCAAe,EAAEJ;AADH,mBAEX9B,KAFW,CAAhB;AAKA;AAAA;AAAA;AACD;;AAED,mBAAKS,WAAL,CAAgB0D;AACd3E,qBAAK,EAAEyG,OAAK,CAACvD,OADC;AAEdQ,yBAAS,EAAE,eAFG;AAGdX,sBAAM,EAAEvE,MAAM,CAACiF;AAHD,iBAIXjD,KAJW,CAAhB;;;;;;;;;;;OAzDiB;AAgEpB,KAhEO;;AA4GA1B,yBAAe;AAAA;;;;;;AACf2B,mBAAiC,KAAKD,KAAtC,EAAEkC,eAAe,qBAAjB,EAAmBuB,SAAS,eAA5B;AACAjD,mBAA0B,KAAKpC,KAA/B,EAAE8H,MAAM,YAAR,EAAU/F,KAAK,WAAf,EAAiBlB,IAAI,UAArB;oBAEFwE,SAAS,IAAI,OAAOyC,MAAP,KAAkB,QAA/B,IAA2C/G,KAAK,CAACC,OAAN,CAAcH,IAAd,IAA3C;AAAA;AAAA;AACF;AAAA;AAAA,gBAAM5B,IAAI,CAAC8C,KAAD,EAAQ;AAAE2B,wBAAQ,EAAEI,eAAZ;AAA6BgE,sBAAM,QAAnC;AAAqCjH,oBAAI;AAAzC,eAAR,CAAV;;;AAAA2E;;;;;;;;;;OALmB;AAOtB,KAPO;;AASAtF,uBAAa,UAAO6H,IAAP,EAAmB;AAAZ;AAAAA;AAAY;;;;;;;;;;AAChClG,mBAA8C,KAAKD,KAAnD,EAAEkC,eAAe,qBAAjB,EAAmBuB,SAAS,eAA5B,EAA8B2C,WAAW,iBAAzC;AACA5F,mBAA0B,KAAKpC,KAA/B,EAAE8H,MAAM,YAAR,EAAU/F,KAAK,WAAf,EAAiBlB,IAAI,UAArB;AACAoH,8BAAgB,GAAGF,IAAI,IAAIC,WAA3B;AACAtH,yBAAW,GAAG,KAAKwH,cAAL,CAAoBrH,IAApB,CAAd;;;;;;mBAIA,KAAKqB,kBAAL;AAAA;AAAA;mBACE,CAACmD,WAAD;AAAA;AAAA;AACF;AAAA;AAAA,gBAAMpG,IAAI,CAAC8C,KAAD,EAAMgE;AACdrC,wBAAQ,EAAEI,eADI;AAEdgE,sBAAM;AAFQ,iBAGVG,gBAAgB,GAAGvH,WAAH,GAAiBE,SAHvB,CAAN,CAAV;;;AAAA4E;;;;;;;AAMA;AAAA;AAAA,gBAAMxG,KAAK,CAAC+C,KAAD,CAAX;;;AAAAyD;;AAEA,mBAAKnD,WAAL,CAAiB;AAAEgD,yBAAS,EAAE;AAAb,eAAjB;;;;AAGF,mBAAKnC,WAAL,GAAmBC,MAAM,CAACC,UAAP,CAAkB;AACnClD,qBAAI,CAACmD,UAAL;AACD,eAFkB,EAEhB,GAFgB,CAAnB;;;;;;mBAGS,KAAKd,QAAL;AAAA;AAAA;AACW;AAAA;AAAA,gBAAM,KAAKA,MAAL,CAAYC,eAAZ,EAAN;;;AAAd2F,yBAAW,GAAG3C,SAAd;oBAIH,CAAC2C,WAAD,IAAgB,CAAC,EAAEzH,WAAW,CAACC,WAAZ,IAA2BD,WAAW,CAACG,IAAzC,CAAlB,IACCoH,gBAAgB,IAAIE,WAApB,IAAmCA,WAAW,CAACnD,SADhD;AAAA;AAAA;AAGA;AAAA;AAAA,gBAAM/F,IAAI,CAAC8C,KAAD,EAAMgE;AACdrC,wBAAQ,EAAEI,eADI;AAEdgE,sBAAM;AAFQ,iBAGVG,gBAAgB,GAAGvH,WAAH,GAAiBE,SAHvB,CAAN,CAAV;;;AAAA4E;;;;;;;AAMA;AAAA;AAAA,gBAAM,KAAKjD,MAAL,CAAYS,UAAZ,EAAN;;;AAAAwC;;;;;AAIJ,kBAAIwC,WAAJ,EAAiB;AACf,qBAAK3F,WAAL,CAAiB;AAAE2F,6BAAW,EAAE;AAAf,iBAAjB;AACD;;;;;;;mCAED;;AACA7G,qBAAO,CAACC,KAAR,CAAcgH,OAAd;;;;;;;;;;;;AAEH,KAjDO;;AAmDAlI,0BAAgB;AAAA;;;;;;AACtB,kBAAI,CAAC,KAAK6C,QAAV,EAAoB;AAClB;AAAA;AAAA;AACD;;AAEKlB,mBAAwB,KAAKD,KAA7B,EAAEU,UAAU,gBAAZ,EAAcX,KAAK,WAAnB;;;;;;mBAIA,KAAKO,kBAAL;AAAA;AAAA;AACER,sBAAQ,GAAGY,UAAU,GAAGX,KAAK,CAACvB,UAA9B;AAEJsB,sBAAQ,GAAG2G,MAAM,CAAC,CAAC,CAACA,MAAM,CAACC,QAAP,CAAgB5G,QAAhB,IAA4BA,QAA5B,GAAuC,CAAxC,IAA6C,GAA9C,EAAmD6G,OAAnD,CAA2D,CAA3D,CAAD,CAAjB;AAEA,mBAAKlG,WAAL,CAAiB;AACfX,wBAAQ,UADO;AAEfY,0BAAU,EAAEA,UAAU,GAAG,KAAKkG;AAFf,eAAjB;;;;;;mBAIS,KAAKjG,QAAL;AAAA;AAAA;AACM;AAAA;AAAA,gBAAM,KAAKA,MAAL,CAAYC,eAAZ,EAAN;;;AAATZ,mBAAK,GAAIQ,SAAT;AAEN;;AACA,kBAAIR,KAAJ,EAAW;AACHI,wBAAQ,GAAGJ,KAAK,CAACF,QAAjB;AACAA,wBAAQ,GAAG2G,MAAM,CACrB,CAAErG,QAAQ,GAAGJ,KAAK,CAACa,YAAN,CAAmBC,aAAnB,CAAiCC,WAA7C,GAA4D,GAA7D,EAAkE4F,OAAlE,CAA0E,CAA1E,CADqB,CAAjB;AAIN,qBAAKlG,WAAL,CAAiB;AACfX,0BAAQ,UADO;AAEfY,4BAAU,EAAEN,QAAQ,GAAG,KAAKwG;AAFb,iBAAjB;AAID;;;;;;;;;;mCAGH;;AACArH,qBAAO,CAACC,KAAR,CAAcqH,OAAd;;;;;;;;;;;OApCoB;AAsCvB,KAtCO;;AAwCAvI,wBAAc,UAAC0B,KAAD,EAAW;AAAV;AAAAA;AAAU;;AAC/B,UAAI,CAAC1B,KAAI,CAAC6C,QAAV,EAAoB;AAClB;AACD;;AAED7C,WAAI,CAACwI,QAAL,CAAc9G,KAAd;AACD,KANO;;AAnuBN1B,SAAI,CAAC0B,KAAL,GAAa;AACXkC,qBAAe,EAAE,EADN;AAEXJ,cAAQ,EAAE,EAFC;AAGXgB,aAAO,EAAE,EAHE;AAIXtD,WAAK,EAAE,EAJI;AAKX0D,eAAS,EAAE,EALA;AAMX/B,cAAQ,EAAE,KANC;AAOXgC,oBAAc,EAAE,KAPL;AAQXwB,iBAAW,EAAE,KARF;AASXlB,eAAS,EAAE,KATA;AAUXjB,aAAO,EAAE,KAVE;AAWXT,mBAAa,EAAE,KAXJ;AAYXqE,iBAAW,EAAE,KAZF;AAaXnC,gBAAU,EAAE,EAbD;AAcX8C,oBAAc,EAAE,QAdL;AAeXjH,cAAQ,EAAE,CAfC;AAgBXoE,oBAAc,EAAE,EAhBL;AAiBXxD,gBAAU,EAAE,CAjBD;AAkBX6B,YAAM,EAAEvE,MAAM,CAACwG,IAlBJ;AAmBXzE,WAAK,EAAEzB,KAAI,CAACqH,UAnBD;AAoBXhC,YAAM,EAAE7F,WAAW,CAACM,KAAK,CAAC4I,aAAP,CAAX,IAAoC;AApBjC,KAAb;AAuBA1I,SAAI,CAAC2I,MAAL,GAAcvJ,eAAe,CAACU,KAAK,CAAC6I,MAAP,CAA7B;;AACD;;AAYYC,iDAAb;;;;;;;;;AACE,iBAAK/F,QAAL,GAAgB,IAAhB;AACQX,iBAAY,aAAK2G,GAAL,CAASC,OAAT,MAAgB,IAAhB,IAAgBnH,aAAhB,GAAgB,MAAhB,GAAgBA,GAAEoH,qBAAF,EAAhB,KAA6C,EAA7C,EAA+CC,GAA3D,KAAG,mBAAG,CAAH,GAAI9G,EAAP;AAER,iBAAKC,WAAL,CAAiB;AACfsG,4BAAc,EAAEO,GAAG,GAAG/F,MAAM,CAACgG,WAAP,GAAqB,CAA3B,GAA+B,QAA/B,GAA0C,KAD3C;AAEfhF,oBAAM,EAAEvE,MAAM,CAACwJ;AAFA,aAAjB;;AAKA,gBAAI,CAACjG,MAAM,CAACkG,4BAAZ,EAA0C;AACxClG,oBAAM,CAACkG,4BAAP,GAAsC,KAAKC,gBAA3C;AACD,aAFD,MAEO;AACL,mBAAKA,gBAAL;AACD;;AAED;AAAA;AAAA,cAAM7J,iBAAiB,EAAvB;;;AAAA+F;;;;;;;;AACD,GAhBY;;AAkBAsD,kDAAb,UAAgCS,aAAhC,EAAsDjD,aAAtD,EAA0E;;;;;;;;;AAClEzE,iBACJ,KAAKD,KADD,EAAEkC,eAAe,qBAAjB,EAAmBJ,QAAQ,cAA3B,EAA6BtC,KAAK,WAAlC,EAAoC2D,cAAc,oBAAlD,EAAoDM,SAAS,eAA7D,EAA+DlB,MAAM,YAArE,EAAuExC,KAAK,WAA5E;AAEAS,iBASF,KAAKpC,KATH,EACJ4D,QAAQ,cADJ,EAEJ9B,QAAQ,cAFJ,EAGJgG,MAAM,YAHF,EAIE0B,QAAQ,UAJV,EAKJC,YAAY,kBALR,EAMJC,kBAAkB,wBANd,EAOJ3H,KAAK,WAPD,EAQJlB,IAAI,UARA;AAUA8I,mBAAO,GAAGrD,aAAa,CAACnC,MAAd,KAAyBvE,MAAM,CAACuG,KAAhC,IAAyChC,MAAM,KAAKvE,MAAM,CAACuG,KAArE;AACAyD,uBAAW,GAAG7I,KAAK,CAACC,OAAN,CAAcH,IAAd,IAChB,CAACrB,YAAY,CAAC+J,aAAa,CAAC1I,IAAf,EAAqBA,IAArB,CADG,GAEhB0I,aAAa,CAAC1I,IAAd,KAAuBA,IAFrB;AAGAH,uBAAW,GAAG,KAAKwH,cAAL,CAAoBrH,IAApB,CAAd;AAEAgJ,mBAAO,GAAG,CAAC,CAAC/F,eAAF,IAAqB,CAAC,EAAEpD,WAAW,CAACC,WAAZ,IAA2BD,WAAW,CAACG,IAAzC,CAAhC;AACAiJ,sBAAU,GAAIF,WAAW,IAAIvE,SAAhB,IAA8B,CAAC,EAAEsE,OAAO,KAAK/F,QAAQ,IAAI4F,QAAjB,CAAT,CAA5C;kBAEFK,OAAO,IAAIC,aAAX;AAAA;AAAA;AACF;AAAA;AAAA,cAAM7K,IAAI,CAAC8C,KAAD,EAAMgE;AAAIrC,sBAAQ,EAAEI,eAAd;AAA+BgE,oBAAM;AAArC,eAA0CpH,WAA1C,CAAN,CAAV;;;AAAA8E;AAEA;;;AACA,gBAAI,CAACH,SAAL,EAAgB;AACd,mBAAKhD,WAAL,CAAiB;AAAEgD,yBAAS,EAAE;AAAb,eAAjB;AACD;;AAED,gBAAI,KAAKnD,gBAAT,EAA2B;AACzB,mBAAKgB,WAAL,GAAmBC,MAAM,CAACC,UAAP,CAAkB;AACnClD,qBAAI,CAACmD,UAAL;AACD,eAFkB,EAEhB,GAFgB,CAAnB;AAGD;;;;;;;AACI,gBAAIuG,WAAW,IAAI,CAACvE,SAApB,EAA+B;AACpC,mBAAKhD,WAAL,CAAiB;AAAE2F,2BAAW,EAAE;AAAf,eAAjB;AACD;;;;;AAED,gBAAI1B,aAAa,CAACnC,MAAd,KAAyBA,MAA7B,EAAqC;AACnCrC,sBAAS,uBACJ,KAAKF,KADD,GACM;AACbgB,oBAAI,EAAE/C,IAAI,CAACD;AADE,eADN,EAAT;AAID;;kBAEG0G,aAAa,CAACxC,eAAd,KAAkCA,eAAlC,IAAqDA,kBAArD;AAAA;AAAA;;AACF,gBAAI,CAAC6F,OAAL,EAAc;AACZ7H,sBAAS,uBACJ,KAAKF,KADD,GACM;AACbgB,oBAAI,EAAE/C,IAAI,CAACkK;AADE,eADN,EAAT;AAID;;AAED;AAAA;AAAA,cAAM,KAAKC,kBAAL,CAAwB,KAAK9H,gBAA7B,CAAN;;;AAAAsD;;AACA;AAAA;AAAA,cAAM,KAAKyE,aAAL,EAAN;;;AAAAzE;;;;;AAGF,gBAAIc,aAAa,CAAC3E,KAAd,CAAoBtB,EAApB,KAA2BsB,KAAK,CAACtB,EAAjC,IAAuCsB,KAAK,CAACtB,EAAjD,EAAqD;AACnDyB,sBAAS,uBACJ,KAAKF,KADD,GACM;AACbgB,oBAAI,EAAE/C,IAAI,CAACqK;AADE,eADN,EAAT;;AAKA,kBAAIT,YAAJ,EAAkB;AAChB,qBAAKpH,WAAL,CAAiB;AAAE+B,yBAAO,EAAE;AAAX,iBAAjB;AACD;AACF;;kBAEGkC,aAAa,CAACjB,SAAd,KAA4BA,YAA5B;AAAA;AAAA;AACF,iBAAK8E,iBAAL;AACA;AAAA;AAAA,cAAM,KAAKH,kBAAL,CAAwB,KAAK9H,gBAA7B,CAAN;;;AAAAsD;;AAEA1D,oBAAS,uBACJ,KAAKF,KADD,GACM;AACbgB,kBAAI,EAAE/C,IAAI,CAACuK;AADE,aADN,EAAT;;;;AAMF,gBAAIrI,KAAK,IAAIwH,aAAa,CAACxH,KAAd,KAAwBA,KAArC,EAA4C;AAC1C,mBAAKsI,WAAL,GAAmB,IAAnB;;AAEA,kBAAI,CAACtF,cAAL,EAAqB;AACnB,qBAAKuE,gBAAL;AACD,eAFD,MAEO;AACL,qBAAKe,WAAL,GAAmB,IAAnB;AACD;AACF;;kBAEGd,aAAa,CAACtK,IAAd,KAAuBuK,QAAvB,IAAmCA,QAAQ,KAAKnE,YAAhD;AAAA;AAAA;AACF;AAAA;AAAA,cAAM,KAAKrC,UAAL,CAAgB,CAACrB,KAAK,CAACtB,EAAvB,CAAN;;;AAAAmF;;;;;kBAGE+D,aAAa,CAACzB,MAAd,KAAyBA,SAAzB;AAAA;AAAA;AACF;AAAA;AAAA,cAAM,KAAKwC,YAAL,EAAN;;;AAAA9E;;;;;kBAGEc,aAAa,CAACvB,cAAd,IAAgC,CAACA,iBAAjC;AAAA;AAAA;;AACF,gBAAI3D,KAAK,KAAK,sBAAV,IAAoC,KAAKiJ,WAA7C,EAA0D;AACxD,mBAAKA,WAAL,GAAmB,KAAnB;AACA,mBAAKf,gBAAL;AACD;;kBAEGI,kBAAkB,IAAI,CAAC7I,OAAvB;AAAA;AAAA;AACkC;AAAA;AAAA,cAAM/B,gBAAgB,CAACiD,KAAD,CAAtB;;;AAA9BQ,kBAAM,GAAwBiD,SAA9B;AAEN;;AACA,gBAAIjD,MAAM,IAAIA,MAAM,CAAC0B,UAAjB,IAA+B1B,MAAM,CAACoF,MAAP,CAActH,EAAd,KAAqBqD,QAAxD,EAAkE;AAChE,mBAAK6G,iBAAL,CAAuBhI,MAAM,CAACoF,MAAP,CAActH,EAArC;AACD;;;;;;;;;;;AAGN,GAhHY;;AAkHNyI,oDAAP;AACE,SAAK/F,QAAL,GAAgB,KAAhB;AAEA;;AACA,QAAI,KAAKR,MAAT,EAAiB;AACf,WAAKA,MAAL,CAAYoC,UAAZ;AACD;;AAED6F,iBAAa,CAAC,KAAKC,kBAAN,CAAb;AACAD,iBAAa,CAAC,KAAKE,sBAAN,CAAb;AACAC,gBAAY,CAAC,KAAKzH,WAAN,CAAZ;AACD,GAXM;;AAaP0H,wBAAY9B,0BAAZ,EAAY,kBAAZ,EAA4B;SAA5B;AACQ,eAAwC,KAAKlH,KAA7C;AAAA,UAAEkC,eAAe,qBAAjB;AAAA,UAAmBJ,QAAQ,cAA3B;AAAA,UAA6BS,MAAM,YAAnC;AAEN,aAAQL,eAAe,IAAIA,eAAe,KAAKJ,QAAxC,IAAqDS,MAAM,KAAKvE,MAAM,CAACgF,WAA9E;AACD,KAJ2B;qBAAA;;AAAA,GAA5B;;AA+QckE,iDAAd,UAAgCzI,EAAhC,EAA0C;;;;;;;AAClCwB,iBAAoC,KAAK7B,KAAzC,EAAE6D,sBAAsB,4BAAxB,EAA0B9B,KAAK,WAA/B;AACc;AAAA;AAAA,cAAMlD,UAAU,CAACkD,KAAD,CAAhB;;;AAAZ2C,mBAAO,GAAKtC,UAAuBsC,OAAnC;AACJZ,2BAAe,GAAGzD,EAAlB;;AAEJ,gBAAIwD,sBAAJ,EAA4B;AACpBgH,gCAAgB9G,cAAc,CAAC+G,OAAf,CAAuB,cAAvB,CAAhB;AAEN;;AACA,kBAAI,CAACD,eAAD,IAAkB,CAACnG,OAAO,CAACrD,IAAR,CAAa,UAACH,CAAD,EAAiB;AAAK,wBAAC,CAACb,EAAF,KAASwK,eAAT;AAAsB,eAAzD,CAAvB,EAAmF;AACjF9G,8BAAc,CAACC,OAAf,CAAuB,cAAvB,EAAuCF,eAAvC;AACD,eAFD,MAEO;AACLA,+BAAe,GAAG+G,eAAlB;AACD;AACF;;AAED;AAAA;AAAA,cAAO;AAAE/G,6BAAe,iBAAjB;AAAmBY,qBAAO;AAA1B,aAAP;;;;AACD,GAjBa;;AAiJAoE,kDAAd,UAAiCiC,UAAjC,EAAoD;;;;;;AAC1CC,sCAA0B,GAAK,KAAKhL,KAAL,CAAUgL,0BAAzC;;;;;;kBAGF,KAAK9I,gBAAL,IAAyB6I,UAAzB,IAAuC,CAAC,KAAKN,qBAA7C;AAAA;AAAA;AACF;AAAA;AAAA,cAAM,KAAKpH,UAAL,EAAN;;;AAAAxB;;AAEA2I,yBAAa,CAAC,KAAKC,kBAAN,CAAb;AACA,iBAAKA,kBAAL,GAA0BtH,MAAM,CAAC8H,WAAP,CACxB,KAAK5H,UADmB,EAExB2H,0BAA2B,GAAG,IAFN,CAA1B;;;;AAMF,gBAAI,CAAC,CAACD,UAAD,IAAe,CAAC,KAAK7I,gBAAtB,KAA2C,KAAKuI,kBAApD,EAAwE;AACtED,2BAAa,CAAC,KAAKC,kBAAN,CAAb;AACA,mBAAKA,kBAAL,GAA0B7J,SAA1B;AACD;;;;;;;kCAED;;AACAO,mBAAO,CAACC,KAAR,CAAc8J,QAAd;;;;;;;;;;;;AAEH,GAtBa;;AAwBNpC,iDAAR;AACU,iBAAS,GAAK,KAAKlH,KAAL,CAAUyD,SAAxB;AAER;;AACA,QAAIA,SAAJ,EAAe;AACb;AACA,UAAI,CAAC,KAAKqF,sBAAV,EAAkC;AAChC,aAAKA,sBAAL,GAA8BvH,MAAM,CAAC8H,WAAP,CAC5B,KAAKhB,aADuB,EAE5B,KAAKzB,kBAFuB,CAA9B;AAID;AACF,KARD,MAQO,IAAI,KAAKkC,sBAAT,EAAiC;AACtCF,mBAAa,CAAC,KAAKE,sBAAN,CAAb;AACA,WAAKA,sBAAL,GAA8B9J,SAA9B;AACD;AACF,GAhBO;;AA8HDkI,sCAAP;AACQ,aAiBF,KAAKlH,KAjBH;AAAA,QACJkC,eAAe,qBADX;AAAA,QAEJJ,QAAQ,cAFJ;AAAA,QAGJgB,OAAO,aAHH;AAAA,QAIJtD,KAAK,WAJD;AAAA,QAKJ0D,SAAS,eALL;AAAA,QAMJ/B,QAAQ,cANJ;AAAA,QAOJwD,WAAW,iBAPP;AAAA,QAQJlB,SAAS,eARL;AAAA,QASJ1B,aAAa,mBATT;AAAA,QAUJkC,UAAU,gBAVN;AAAA,QAWJ8C,cAAc,oBAXV;AAAA,QAYJjH,QAAQ,cAZJ;AAAA,QAaJoE,cAAc,oBAbV;AAAA,QAcJ3B,MAAM,YAdF;AAAA,QAeJxC,KAAK,WAfD;AAAA,QAgBJ4D,MAAM,YAhBF;AAkBA,aAAmD,KAAKvF,KAAxD;AAAA,QAAEO,IAAI,UAAN;AAAA,QAAQkJ,YAAY,kBAApB;AAAA,QAAsB1H,KAAK,WAA3B;AAAA,QAA6BoJ,iBAAiB,uBAA9C;AACN,QAAMxB,OAAO,GAAG,CAAC/J,MAAM,CAACuG,KAAR,EAAevG,MAAM,CAACgF,WAAtB,EAAmCwG,OAAnC,CAA2CjH,MAA3C,KAAsD,CAAtE;AACA,QAAMI,eAAe,GAAGO,SAAS,KAAK,gBAAtC;AAEA,QAAIuG,MAAM,GAAGlN,oBAACO,MAAD,EAAO;AAACmK,YAAM,EAAE,KAAKA;AAAd,KAAP,CAAb;AACA,QAAIyC,IAAJ;;AAEA,QAAI/G,eAAJ,EAAqB;AACnB+G,UAAI,GAAGnN,+BAAIiD,KAAJ,CAAP;AACD;;AAED,QAAIuI,OAAJ,EAAa;AACX;AACA,UAAI,CAAC2B,IAAL,EAAW;AACTA,YAAI,GACFnN,oBAACM,IAAD,EAAK;AACHsE,kBAAQ,EAAEA,QADP;AAEHwI,gCAAsB,EAAE,KAAKC,0BAF1B;AAGH/B,sBAAY,EAAEA,YAHX;AAIHZ,gBAAM,EAAE,KAAKA,MAJV;AAKH9G,eAAK,EAAEA,KALJ;AAMHJ,eAAK,EAAEA,KANJ;AAOHwJ,2BAAiB,EAAEA;AAPhB,SAAL,CADF;AAWD;;AAEDE,YAAM,GACJlN,0CACEA,iCAAMmN,IAAN,CADF,EAEEnN,oBAACI,QAAD,EAAS;AACPkN,wBAAgB,EAAE,KAAKvJ,gBADhB;AAEPmD,iBAAS,EAAEA,SAFJ;AAGPQ,kBAAU,EAAEA,UAHL;AAIP6F,mBAAW,EAAE,KAAKC,eAJX;AAKPC,uBAAe,EAAE,KAAKC,mBALf;AAMPC,yBAAiB,EAAE,KAAKC,qBANjB;AAOPjG,sBAAc,EAAEA,cAPT;AAQP+C,cAAM,EAAE,KAAKA;AARN,OAAT,CAFF,EAYE1K,oBAACE,OAAD,EAAQ;AACNyF,uBAAe,EAAEA,eADX;AAENJ,gBAAQ,EAAEA,QAFJ;AAGNgB,eAAO,EAAEA,OAHH;AAINsH,qBAAa,EAAErI,aAAa,IAAI,CAACD,QAJ3B;AAKNuI,qBAAa,EAAE,KAAKC,iBALd;AAMNvD,sBAAc,EAAEA,cANV;AAONtJ,iBAAS,EAAE,KAAKA,SAPV;AAQNwJ,cAAM,EAAE,KAAKA,MARP;AASNtD,cAAM,EAAEA;AATF,OAAR,CAZF,CADF;AA0BD;;AAED,QAAIpB,MAAM,KAAKvE,MAAM,CAACiF,KAAtB,EAA6B;AAC3BwG,YAAM,GACJlN,oBAACK,YAAD,EAAa;AAACqK,cAAM,EAAE,KAAKA;AAAd,OAAb,EACGtI,IADH,QACWa,KADX,CADF;AAKD;;AAED,WACEjD,oBAACQ,MAAD,EAAO;AAACoK,SAAG,EAAE,KAAKA,GAAX;AAAgBF,YAAM,EAAE,KAAKA;AAA7B,KAAP,EACGc,OAAO,IACNxL,oBAACS,MAAD,EAAO;AACL2H,iBAAW,EAAEA,WADR;AAEL4F,mBAAa,EAAE,KAAKC,iBAFf;AAGLC,qBAAe,EAAE,KAAKC,mBAHjB;AAIL5K,cAAQ,EAAEA,QAJL;AAKLmH,YAAM,EAAE,KAAKA;AALR,KAAP,CAFJ,EAUE1K,oBAACG,OAAD,EAAQ;AAACuK,YAAM,EAAE,KAAKA;AAAd,KAAR,EAA+BwC,MAA/B,CAVF,CADF;AAcD,GAhGM,CAxyBT,CAuFE;;;AACOvC,kCAAe;AACpBhH,YAAQ,EAAE;AAAM;AAAS,KADL;AAEpBuE,wBAAoB,EAAE,KAFF;AAGpB9F,QAAI,EAAE,oBAHc;AAIpBkJ,gBAAY,EAAE,KAJM;AAKpBuB,8BAA0B,EAAE,CALR;AAMpBtB,sBAAkB,EAAE;AANA,GAAf;AAizBT;AAz4BA,EAA+BvL,KAAK,CAACoO,aAArC;;AA24BA,SAAS3M,MAAT,EAAiBC,IAAjB;AAEA,cAAc,SAAd;AAEA,eAAeiJ,gBAAf","names":["React","memoize","Actions","Content","Controls","ErrorMessage","Info","Loader","Player","Slider","getDevices","getPlaybackState","next","pause","play","previous","seek","setDevice","setVolume","getMergedStyles","getSpotifyURIType","isEqualArray","loadSpotifyPlayer","parseVolume","round","STATUS","TYPE","validateURI","__extends","props","_super","_this","artists","durationMs","id","image","name","uri","data","playOptions","context_uri","undefined","uris","ids","Array","isArray","every","d","console","error","some","warn","filter","length","createRef","position","track","state","_a","callback","token","progress","percentage","isExternalPlayer","Math","_b","updateState","progressMs","player","getCurrentState","track_window","current_track","duration_ms","type","PROGRESS","error_1","isActive","togglePlay","error_2","syncTimeout","window","setTimeout","syncDevice","previousTrack","error_3","nextTrack","error_4","deviceId","isUnsupported","autoPlay","persistDeviceSelection","currentDeviceId","sessionStorage","setItem","is_playing","error_5","status","isSaved","FAVORITE","message","isPlaybackError","isInitializationError","nextStatus","devices","disconnect","UNSUPPORTED","ERROR","errorType","isInitializing","paused","album","name_1","next_tracks","previous_tracks","isPlaying","getVolume","volume","_c","map","join","setAlbumImage","trackState","nextTracks","previousTracks","__assign","error_6","device_id","initializeDevices","READY","IDLE","magnifySliderOnHover","previousState","isMagnified","Spotify","getOAuthToken","addListener","handlePlayerStatus","handlePlayerStateChanges","handlePlayerErrors","connect","width","min","apply","__spreadArray","images","thumb","find","url","emptyTrack","Error","item","progress_ms","device","volume_percent","error_7","offset","init","needsUpdate","shouldInitialize","getPlayOptions","playerState","error_8","Number","isFinite","toFixed","seekUpdateInterval","error_9","setState","playerPosition","initialVolume","styles","SpotifyWebPlayer","ref","current","getBoundingClientRect","top","innerHeight","INITIALIZING","onSpotifyWebPlaybackSDKReady","initializePlayer","previousProps","playProp","showSaveIcon","syncExternalDevice","isReady","changedURIs","canPlay","shouldPlay","DEVICE","toggleSyncInterval","updateSeekBar","TRACK","toggleProgressBar","PLAYER","hasNewToken","toggleOffset","setExternalDevice","clearInterval","playerSyncInterval","playerProgressInterval","clearTimeout","Object","savedDeviceId_1","getItem","shouldSync","syncExternalDeviceInterval","setInterval","error_10","updateSavedStatus","indexOf","output","info","onFavoriteStatusChange","handleFavoriteStatusChange","isExternalDevice","onClickNext","handleClickNext","onClickPrevious","handleClickPrevious","onClickTogglePlay","handleClickTogglePlay","isDevicesOpen","onClickDevice","handleClickDevice","onChangeRange","handleChangeRange","onToggleMagnify","handleToggleMagnify","PureComponent"],"sourceRoot":"","sources":["../src/index.tsx"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}